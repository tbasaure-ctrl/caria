# Replication Package: "Accumulated Spectral Fragility and Structural Risk"

This package contains the code and instructions to replicate the empirical findings of the manuscript. The core contribution is the "Phase Transition" in market risk, where the relationship between fragility and risk flips sign based on connectivity.

## ðŸ“ Manifest

| File | Description |
|:---|:---|
| `fetch_fmp_data.py` | Python script to download the **Global Macro Universe** (38 assets) from FMP API. |
| `global_phase_transition.py` | Estimation script for the **Threshold Regression Model**. Identifies $\tau$ and estimates regime-dependent $\theta$. |
| `global_strategy_backtest.py` | Backtesting engine for the **Regime-Conditional Strategy**. |
| `plot_3d_wireframe.py` | Visualization script for the 3D Risk Surface (Figure 3 in paper). |
| `media/Global_Macro_Prices_FMP.csv` | cached dataset (generated by fetch script). |
| `outputs/Global_Phase_Transition.txt` | Regression results summary. |
| `outputs/Table_Global_Strategy.csv` | Strategy performance metrics. |

## ðŸš€ Quick Start

### 1. Prerequisites
Ensure you have Python 3.8+ and the following libraries installed:
```bash
pip install pandas numpy matplotlib seaborn scikit-learn statsmodels requests
```
*(Note: An FMP API Key is required for `fetch_fmp_data.py`. A key is pre-configured in the script for peer review purposes.)*

### 2. Step-by-Step Replication

#### Step 1: Data Acquisition
Download the Global Macro dataset (Equities, Rates, Credit, Commodities).
```bash
python fetch_fmp_data.py
```
*Output: `media/Global_Macro_Prices_FMP.csv`*

#### Step 2: Test the Phase Transition Hypothesis
Run the Threshold Regression search to identify the critical connectivity level ($\tau$) and test the sign flip.
```bash
python global_phase_transition.py
```
*Expected Output:*
- Optimal Threshold: $\tau \approx 0.28$
- Low Connectivity Slope ($\theta_L$): Positive (Contagion)
- High Connectivity Slope ($\theta_H$): Negative (Disintegration)

#### Step 3: Run the Strategy Backtest
Execute the Regime-Conditional Asset Allocation strategy (1.3x Safe / 0.5x Danger).
```bash
python global_strategy_backtest.py
```
*Expected Output:*
- CAGR > Benchmark
- Sharpe Ratio maintained or improved
- Reduced Drawdown/Underwater time

#### Step 4: Visualize the Phase Transition
Generate the 3D Wireframe plot used in the manuscript.
```bash
python plot_3d_wireframe.py
```
*Output: `media/Figure_Phase_Transition_3D.png`*

## ðŸ“œ Methodology Notes

- **Spectral Entropy:** Calculated on the correlation matrix of standardized returns using the Ledoit-Wolf shrinkage estimator.
- **Accumulation (ASF):** While instantaneous entropy ($H_t$) is noisy, ASF is an exponentially weighted moving average ($\lambda \approx 0.02$) representing the *stock* of fragility.
- **Threshold Model:** We search for $\tau$ via grid search to minimize the sum of squared residuals (Hansen, 2000).

## ðŸ“§ Contact
For questions regarding the code or data, please contact the corresponding author.
