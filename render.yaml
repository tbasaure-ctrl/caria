services:
  - type: web
    name: caria-api
    env: docker
    dockerfilePath: backend/Dockerfile
    dockerContext: .
    # Important: Make sure Render uses backend/Dockerfile, not root Dockerfile
    plan: starter
    region: oregon
    buildCommand: ""
    startCommand: /app/backend/start.sh
    healthCheckPath: /health
    envVars:
      - key: DATABASE_URL
        sync: false
        # Use Neon connection string: postgresql://user:password@host.neon.tech/dbname?sslmode=require
        # Or pooled: postgresql://user:password@host-pooler.neon.tech/dbname?sslmode=require
      - key: LLAMA_API_KEY
        sync: false
        # Set this in Render dashboard (get from Groq console)
      - key: LLAMA_API_URL
        value: https://api.groq.com/openai/v1/chat/completions
      - key: LLAMA_MODEL
        value: llama-3.1-8b-instruct
      - key: REDDIT_CLIENT_ID
        sync: false
      - key: REDDIT_CLIENT_SECRET
        sync: false
      - key: REDDIT_USER_AGENT
        value: Caria-Investment-App-v1.0
      - key: FMP_API_KEY
        sync: false
      - key: JWT_SECRET_KEY
        sync: false
      - key: RETRIEVAL_PROVIDER
        value: local
      - key: RETRIEVAL_EMBEDDING_DIM
        value: "768"
      - key: RETRIEVAL_EMBEDDING_MODEL
        value: nomic-embed-text-v1
      - key: PORT
        value: "8080"
      - key: CORS_ORIGINS
        value: https://caria-way.com;https://caria-git-main-tomas-projects-70a0592d.vercel.app

# Note: Using Neon PostgreSQL (external) instead of Render PostgreSQL
# Neon includes pgvector extension needed for RAG
# Configure DATABASE_URL with your Neon connection string
